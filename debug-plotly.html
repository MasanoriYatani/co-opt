<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  ãƒ‡ãƒãƒƒã‚°</title>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <style>
        body { font-family: monospace; margin: 20px; background: #f5f5f5; }
        .test-container { background: white; padding: 20px; margin: 10px 0; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { border-left: 4px solid #00aa00; }
        .error { border-left: 4px solid #cc0000; }
        .warning { border-left: 4px solid #ff8800; }
        h2 { color: #333; margin-top: 0; }
        .plot-container { width: 100%; height: 400px; margin: 20px 0; border: 1px solid #ddd; border-radius: 3px; }
        code { background: #eee; padding: 2px 5px; border-radius: 2px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; background: #0066cc; color: white; border: none; border-radius: 3px; }
        button:hover { background: #0052a3; }
    </style>
</head>
<body>
    <h1>ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  - Plotly ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-container success">
        <h2>âœ… Plotly ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç¢ºèª</h2>
        <div id="plotly-check"></div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆ1: ã‚·ãƒ³ãƒ—ãƒ«ãªæ•£å¸ƒå›³</h2>
        <button onclick="testPlotly1()">ãƒ—ãƒ­ãƒƒãƒˆ1ã‚’å®Ÿè¡Œ</button>
        <div id="plot1" class="plot-container"></div>
        <div id="plot1-result"></div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆ2: ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
        <button onclick="testPlotly2()">ãƒ—ãƒ­ãƒƒãƒˆ2ã‚’å®Ÿè¡Œ</button>
        <div id="plot2" class="plot-container"></div>
        <div id="plot2-result"></div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒƒãƒˆ3: è¤‡æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h2>
        <button onclick="testPlotly3()">ãƒ—ãƒ­ãƒƒãƒˆ3ã‚’å®Ÿè¡Œ</button>
        <div id="plot3" class="plot-container"></div>
        <div id="plot3-result"></div>
    </div>

    <script>
        // Plotly ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç¢ºèª
        function checkPlotly() {
            const checkDiv = document.getElementById('plotly-check');
            if (typeof window.Plotly === 'undefined') {
                checkDiv.innerHTML = '<span style="color: red;">âŒ Plotly ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“</span>';
                return false;
            }
            
            if (typeof window.Plotly.newPlot !== 'function') {
                checkDiv.innerHTML = '<span style="color: red;">âŒ Plotly.newPlot é–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</span>';
                return false;
            }
            
            checkDiv.innerHTML = `
                <span style="color: green;">âœ… Plotly ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯æ­£å¸¸ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã™</span><br>
                <code>window.Plotly.version = ${window.Plotly.version || 'unknown'}</code><br>
                <code>typeof window.Plotly.newPlot = ${typeof window.Plotly.newPlot}</code>
            `;
            return true;
        }
        
        function testPlotly1() {
            const resultDiv = document.getElementById('plot1-result');
            const plotDiv = document.getElementById('plot1');
            plotDiv.innerHTML = '';
            resultDiv.innerHTML = '';
            
            try {
                const trace = {
                    x: [-1, 0, 1, 2, 3],
                    y: [1, 0, 2, 1, 3],
                    mode: 'markers',
                    type: 'scatter',
                    marker: { size: 10, color: 'blue' }
                };
                
                const layout = {
                    title: 'ã‚·ãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆ',
                    xaxis: { title: 'X' },
                    yaxis: { title: 'Y' },
                    width: 620,
                    height: 400
                };
                
                window.Plotly.newPlot(plotDiv, [trace], layout);
                resultDiv.innerHTML = '<span style="color: green;">âœ… ãƒ—ãƒ­ãƒƒãƒˆ1 æˆåŠŸ</span>';
                console.log('âœ… testPlotly1 completed');
            } catch (error) {
                resultDiv.innerHTML = `<span style="color: red;">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                console.error('âŒ testPlotly1 error:', error);
            }
        }
        
        function testPlotly2() {
            const resultDiv = document.getElementById('plot2-result');
            const plotDiv = document.getElementById('plot2');
            plotDiv.innerHTML = '';
            resultDiv.innerHTML = '';
            
            try {
                // ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªã‚¹ãƒãƒƒãƒˆï¼‰
                const xPoints = [];
                const yPoints = [];
                for (let i = 0; i < 100; i++) {
                    xPoints.push((Math.random() - 0.5) * 2);  // -1 to 1 Î¼m
                    yPoints.push((Math.random() - 0.5) * 2);
                }
                
                const trace = {
                    x: xPoints,
                    y: yPoints,
                    mode: 'markers',
                    type: 'scatter',
                    marker: {
                        size: 5,
                        color: 'rgba(0, 100, 200, 0.7)',
                        opacity: 0.8
                    }
                };
                
                const layout = {
                    title: 'ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ  ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',
                    xaxis: { 
                        title: 'X (Î¼m)',
                        scaleanchor: 'y',
                        scaleratio: 1
                    },
                    yaxis: { 
                        title: 'Y (Î¼m)',
                        scaleanchor: 'x',
                        scaleratio: 1
                    },
                    width: 620,
                    height: 400,
                    hovermode: 'closest'
                };
                
                window.Plotly.newPlot(plotDiv, [trace], layout);
                resultDiv.innerHTML = `<span style="color: green;">âœ… ãƒ—ãƒ­ãƒƒãƒˆ2 æˆåŠŸï¼ˆ${xPoints.length}ãƒã‚¤ãƒ³ãƒˆï¼‰</span>`;
                console.log('âœ… testPlotly2 completed');
            } catch (error) {
                resultDiv.innerHTML = `<span style="color: red;">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                console.error('âŒ testPlotly2 error:', error);
            }
        }
        
        function testPlotly3() {
            const resultDiv = document.getElementById('plot3-result');
            const plotDiv = document.getElementById('plot3');
            plotDiv.innerHTML = '';
            resultDiv.innerHTML = '';
            
            try {
                // è¤‡æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ 
                const traces = [];
                const colors = ['blue', 'red', 'green', 'orange'];
                
                for (let objIndex = 0; objIndex < 3; objIndex++) {
                    const xPoints = [];
                    const yPoints = [];
                    const centerX = (objIndex - 1) * 0.5;
                    const centerY = (objIndex - 1) * 0.5;
                    
                    for (let i = 0; i < 50; i++) {
                        xPoints.push(centerX + (Math.random() - 0.5) * 0.8);
                        yPoints.push(centerY + (Math.random() - 0.5) * 0.8);
                    }
                    
                    traces.push({
                        x: xPoints,
                        y: yPoints,
                        mode: 'markers',
                        type: 'scatter',
                        name: `Object ${objIndex}`,
                        marker: {
                            size: 5,
                            color: colors[objIndex],
                            opacity: 0.7
                        }
                    });
                }
                
                const layout = {
                    title: 'è¤‡æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ ã‚¹ãƒãƒƒãƒˆãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ',
                    xaxis: { 
                        title: 'X (Î¼m)',
                        scaleanchor: 'y',
                        scaleratio: 1
                    },
                    yaxis: { 
                        title: 'Y (Î¼m)',
                        scaleanchor: 'x',
                        scaleratio: 1
                    },
                    width: 620,
                    height: 400,
                    hovermode: 'closest'
                };
                
                window.Plotly.newPlot(plotDiv, traces, layout);
                resultDiv.innerHTML = `<span style="color: green;">âœ… ãƒ—ãƒ­ãƒƒãƒˆ3 æˆåŠŸï¼ˆ${traces.length}ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰</span>`;
                console.log('âœ… testPlotly3 completed');
            } catch (error) {
                resultDiv.innerHTML = `<span style="color: red;">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</span>`;
                console.error('âŒ testPlotly3 error:', error);
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        window.addEventListener('load', () => {
            console.log('ğŸ” ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†ã€Plotly ãƒã‚§ãƒƒã‚¯é–‹å§‹');
            checkPlotly();
        });
    </script>
</body>
</html>
